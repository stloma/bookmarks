{"version":3,"sources":["../../../src/server/scripts/favicon.js"],"names":["download","url","id","address","match","Error","options","uri","encoding","followRedirect","timeout","maxRedirect","then","outputFile","join","__dirname","result","catch","error"],"mappings":";;;;;kBAIwBA,Q;;AAJxB;;;;AACA;;;;AACA;;;;;;AAEe,SAASA,QAAT,CAAkBC,GAAlB,EAAuBC,EAAvB,EAA2B;AACxC,MAAIC,UAAUF,IAAIG,KAAJ,CAAU,kDAAV,CAAd;AACA,MAAID,OAAJ,EAAa;AACXA,cAAUA,QAAQ,CAAR,CAAV;AACD,GAFD,MAEO;AAAE,UAAME,MAAM,eAAN,CAAN;AAA8B;AACvC,MAAMC,UAAU;AACdC,SAAQJ,OAAR,iBADc;AAEdK,cAAU,IAFI;AAGdC,oBAAgB,IAHF;AAIdC,aAAS,IAJK;AAKdC,iBAAa;AALC,GAAhB;;AAQA,SAAO,8BAAGL,OAAH,EACJM,IADI,CACC;AAAA,WAAU,kBAAGC,UAAH,CAAc,eAAKC,IAAL,CAAUC,SAAV,qCAAsDb,EAAtD,UAAd,EAA+Ec,MAA/E,CAAV;AAAA,GADD,EAEJJ,IAFI,CAEC;AAAA,WAAM,GAAN;AAAA,GAFD,EAGJK,KAHI,CAGE;AAAA,WAASC,KAAT;AAAA,GAHF,CAAP;AAID","file":"favicon.js","sourcesContent":["import rp from 'request-promise'\nimport path from 'path'\nimport fs from 'fs-extra'\n\nexport default function download(url, id) {\n  let address = url.match(/^(https?:\\/\\/){1}[^-][a-z0-9.-]+[^-]\\.[a-z]{2,4}/)\n  if (address) {\n    address = address[0]\n  } else { throw Error('Malformed url') }\n  const options = {\n    uri: `${address}/favicon.ico`,\n    encoding: null,\n    followRedirect: true,\n    timeout: 5000,\n    maxRedirect: 5\n  }\n\n  return rp(options)\n    .then(result => fs.outputFile(path.join(__dirname, `../../../dist/images/favicons/${id}.ico`), result))\n    .then(() => 200)\n    .catch(error => error)\n}\n"]}